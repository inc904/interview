## xss 攻击和 csrf 攻击

xss 是跨站脚本攻击，csrf 是跨站请求伪造攻击。

## xss

攻击者将脚本注入到网页中，当用户访问网页时，脚本会被执行。

攻击本质： 利用开发者对用户输入内容的不充分过滤，破坏网页的安全性

- 存储型 xss
  - 恶意脚本被存储到服务器（如评论区、用户资料）
  - 危害最大，所有访问页面的用户都会受影响
- 反射型 xss
  - 恶意脚本被存储在 url 中
  - 当用户点击链接时，脚本会被执行
  - 危害较小，只有被点击的用户会受影响
- 基于 DOM 的 xss
  - 前端漏洞，通过修改 DOM 触发。如（location.hash, innerHTML 操作）

### 防御

1. 对用户输入进行转义处理
2. 后端配合对用户输入进行过滤
3. 关键 cookie 设置 HttpOnly

## CORS 跨站请求伪造

诱导用户访问恶意页面，利用已登录状态发起非法请求。

攻击本质：利用浏览器自动携带 cookie 的机制，破坏请求的不可伪造性

典型攻击流程：

1. 用户登陆银行网站 A， cookie 存在浏览器
2. 用户访问恶意网站 B
3. B 网站携带用户 cookie 向 A 发起转账请求

防御：
前端配合，在请求头中添加 token

为什么能防御 CSRF？

1. 攻击者无法读取 Token

受同源策略限制，恶意网站无法读取目标网站的 Token（Token 未存储在 Cookie 中，或通过加密 Cookie 单独存储）

2. Token 具有随机性和时效性

每次会话生成新 Token，或为每个表单生成唯一 Token

即使攻击者通过 XSS 泄露了旧 Token，也无法重复利用

3.  双重验证机制

Cookie 由浏览器自动携带（可能被恶意利用）

Token 需显式携带（攻击者无法伪造）
