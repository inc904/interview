# 从页面全屏 FullScreen 看浏览器兼容性

第一次封装：

```js
// 全屏控制器 (自动预检测兼容方法)
const fullscreen = (() => {
  // 1. 定义可能的前缀组合（按优先级排序）
  const prefixGroups = [
    // 标准 API (现代浏览器)
    {
      isFull: 'fullscreenElement',
      enter: 'requestFullscreen',
      exit: 'exitFullscreen',
      prefix: '',
    },
    // WebKit 内核 (Chrome/Safari)
    {
      isFull: 'webkitFullscreenElement',
      enter: 'webkitRequestFullscreen',
      exit: 'webkitExitFullscreen',
      prefix: 'webkit',
    },
    // Gecko 内核 (Firefox)
    {
      isFull: 'mozFullScreenElement',
      enter: 'mozRequestFullScreen',
      exit: 'mozCancelFullScreen',
      prefix: 'moz',
    },
    // Trident/EdgeHTML 内核 (IE/旧Edge)
    {
      isFull: 'msFullscreenElement',
      enter: 'msRequestFullscreen',
      exit: 'msExitFullscreen',
      prefix: 'ms',
    },
  ]

  // 2. 预检测兼容的分组
  let compatibleGroup = null
  const element = document.documentElement

  for (const group of prefixGroups) {
    // 检查该分组是否可用
    const isFullSupported = document[group.isFull] !== undefined
    const exitSupported = typeof document[group.exit] === 'function'
    const enterSupported = typeof element[group.enter] === 'function'

    if (isFullSupported && exitSupported && enterSupported) {
      compatibleGroup = group
      break // 找到第一个可用分组即停止
    }
  }

  // 3. 无兼容 API 时返回空操作
  if (!compatibleGroup) {
    console.warn('Fullscreen API not supported')
    return {
      toggle: () => {},
      enter: () => {},
      exit: () => {},
      isFull: () => false,
    }
  }

  // 4. 返回统一操作方法
  return {
    // 切换全屏
    toggle: () => {
      this.isFull() ? this.exit() : this.enter()
    },
    // 进入全屏
    enter: () => element[compatibleGroup.enter](),
    // 退出全屏
    exit: () => document[compatibleGroup.exit](),
    // 检测全屏状态
    isFull: () => !!document[compatibleGroup.isFull],
  }
})()

// 使用示例
document.getElementById('toggleBtn').addEventListener('click', () => {
  fullscreen.toggle()
  console.log('当前全屏状态:', fullscreen.isFull())
})
```

第二次结合 VueUse 封装

```js
const _document = document.documentElement
// 探测浏览器支持的 进入全屏方法
const requestMethod = () => {
  return [
    'requestFullscreen',
    'webkitRequestFullscreen',
    'webkitEnterFullscreen',
    'webkitEnterFullScreen',
    'webkitRequestFullScreen',
    'mozRequestFullScreen',
    'msRequestFullscreen',
  ].find((m) => _document && m in _document)
}
// 检测浏览器支持的 退出全屏方法
const exitMethod = () => {
  return [
    'exitFullscreen',
    'webkitExitFullscreen',
    'webkitExitFullScreen',
    'webkitCancelFullScreen',
    'mozCancelFullScreen',
    'msExitFullscreen',
  ].find((m) => _document && m in _document)
}

// 检测是否处于全屏状态的属性名
const fullscreenEnabled = () => {
  return [
    'fullScreen',
    'webkitIsFullScreen',
    'webkitDisplayingFullscreen',
    'mozFullScreen',
    'msFullscreenElement',
  ].find((m) => _document && m in _document)
}

// 获取当前全屏元素的属性名
const fullscreenElementMethod = [
  'fullscreenElement',
  'webkitFullscreenElement',
  'mozFullScreenElement',
  'msFullscreenElement',
].find((m) => _document && m in _document)
```
